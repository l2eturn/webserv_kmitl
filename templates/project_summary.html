{% extends "layout.html" %}

{% block title %}สรุปผลการคำนวณน้ำหนัก{% endblock %}

{% block content %}

<style>
    /* --- CSS จากหน้า project_select.html (รูปที่ 2) --- */
    :root {
        --card-shadow: 0 10px 30px rgba(0,0,0,0.08);
        --primary-gradient: linear-gradient(135deg, #0d47a1 0%, #1976d2 100%); /* สีน้ำเงินเข้ม (Main) */
        --secondary-gradient: linear-gradient(135deg, #198754 0%, #20c997 100%); /* สีเขียว (Sub) */
    }

    .page-header { text-align: center; margin-bottom: 30px; margin-top: 20px; }
    .page-header h2 { font-weight: 800; color: #333; }
    .page-header::after { content: ''; display: block; width: 60px; height: 4px; background: var(--secondary-gradient); margin: 15px auto 0; border-radius: 2px; }

    .modern-card {
        background: white; border: none; border-radius: 20px;
        box-shadow: var(--card-shadow); overflow: hidden; margin-bottom: 30px;
        transition: transform 0.3s, box-shadow 0.3s;
    }
    .modern-card:hover { transform: translateY(-5px); box-shadow: 0 15px 40px rgba(0,0,0,0.12); }

    /* --- Header ของการ์ด --- */
    .card-header-modern {
        padding: 15px 20px; font-weight: 700; color: white; border-radius: 20px 20px 0 0;
        display: flex; align-items: center; justify-content: space-between; font-size: 1.1rem;
    }
    /* สีน้ำเงินสำหรับ Main Criteria */
    .header-main { background: var(--primary-gradient); }
    /* สีเขียวสำหรับ Sub Criteria */
    .header-sub { background: var(--secondary-gradient); }

    /* Table & Button Styles */
    .table-result td { padding: 12px 15px; border-bottom: 1px solid #f0f0f0; vertical-align: middle; }
    .table-result tr:last-child td { border-bottom: none; }
    
    .btn-next {
        border-radius: 50px; padding: 12px 40px; font-weight: 600;
        background: var(--secondary-gradient); color: white; border: none;
        box-shadow: 0 4px 15px rgba(25, 135, 84, 0.3); transition: 0.3s;
    }
    .btn-next:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(25, 135, 84, 0.4); color: white; }
    
    .alert-modern {
        background-color: #d1e7dd; color: #0f5132; border: 1px solid #badbcc;
        border-radius: 12px; padding: 15px; font-weight: 500;
    }
</style>

<div class="row justify-content-center">
    <div class="col-lg-11">
        
        <div class="page-header">
            <h2>สรุปผลการคำนวณน้ำหนัก</h2>
            <p class="text-muted">โปรเจกต์: <strong>{{ project_name }}</strong></p>
        </div>

        <div class="modern-card mb-5 p-4">
            
            <div class="alert-modern text-center mb-5">
                <i class="bi bi-check-circle-fill me-2"></i> 
                ระบบได้ทำการคำนวณ F-BWM จากผู้เชี่ยวชาญทั้ง 3 ท่าน และบันทึกข้อมูลเรียบร้อยแล้ว
            </div>

            <h4 class="fw-bold mb-4 text-dark text-center">
                <i class="bi bi-bar-chart-line-fill text-primary me-2"></i> ค่าน้ำหนักที่ได้ (Global Weights)
            </h4>

            <div class="row g-4">
                {% for group in ranking_data %}
                <div class="col-md-6">
                    <div class="modern-card" style="border: 1px solid #eee; box-shadow: 0 4px 10px rgba(0,0,0,0.05);">
                        <div class="card-header-modern {% if group.main %}header-main{% else %}header-sub{% endif %}">
                            <span>
                                {% if group.main %}<i class="bi bi-layers-fill me-2"></i>{% else %}<i class="bi bi-list-nested me-2"></i>{% endif %}
                                {{ group.title }}
                            </span>
                        </div>
                        
                        <div class="p-3">
                            <table class="table table-borderless table-result mb-0">
                                <tbody>
                                    {% for item in group.members %}
                                    <tr>
                                        <td width="20%" class="text-secondary fw-bold">
                                            <span class="badge bg-light text-dark border">{{ item.code }}</span>
                                        </td>
                                        <td>{{ item.name }}</td>
                                        <td class="text-end fw-bold text-primary">{{ "%.4f"|format(item.score) }}</td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>

            <div class="text-center mt-5 pt-4 border-top">
                <p class="text-muted mb-3">ตรวจสอบความถูกต้องเรียบร้อยแล้ว?</p>
                <a href="{{ url_for('input_form') }}" class="btn btn-next">
                    ดำเนินการต่อ (ทำ TOPSIS) <i class="bi bi-arrow-right-circle-fill ms-2"></i>
                </a>
            </div>

        </div>
    </div>
</div>

{% endblock %}